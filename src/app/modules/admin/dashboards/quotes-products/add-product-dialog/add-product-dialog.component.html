<mat-dialog-content class="p-4" style="max-height: 75vh; overflow-y: auto;">
  <!-- Título -->
  <h2 mat-dialog-title class="text-xl font-bold mb-4 text-center md:text-left">
    Buscar Producto
  </h2>

  <!-- Barra de búsqueda -->
  <div class="flex flex-col md:flex-row gap-2 mb-4">
    <mat-form-field appearance="fill" class="flex-1">
      <mat-label>Nombre o código</mat-label>
      <input
        matInput
        [(ngModel)]="query"
        (keyup.enter)="buscar()"
        placeholder="Ej. Tornillo o T-123"
      />
    </mat-form-field>

    <button
      mat-flat-button
      color="primary"
      class="w-full md:w-auto self-end md:self-auto"
      (click)="buscar()"
    >
      Buscar
    </button>
  </div>

  <!-- Tabla con scroll -->
  <div class="overflow-x-auto max-h-[45vh] border rounded table-scroll-container">
    <table
      mat-table
      [dataSource]="resultados"
      *ngIf="resultados.length > 0"
      class="w-full min-w-[768px] border-separate table-auto"
    >
      <!-- Columnas -->
      <ng-container matColumnDef="nombreProducto">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Producto</th>
        <td mat-cell *matCellDef="let p">{{ p.nombreProducto }}</td>
      </ng-container>

      <ng-container matColumnDef="codigoProducto">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Código</th>
        <td mat-cell *matCellDef="let p">{{ p.codigoProducto }}</td>
      </ng-container>

      <ng-container matColumnDef="unidadMedida">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Unidad</th>
        <td mat-cell *matCellDef="let p">{{ p.unidadMedida }}</td>
      </ng-container>

      <ng-container matColumnDef="precio">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Precio</th>
        <td mat-cell *matCellDef="let p">{{ p.precio | currency: 'MXN' }}</td>
      </ng-container>

      <ng-container matColumnDef="cantidad">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Cantidad</th>
        <td mat-cell *matCellDef="let p">
          <mat-form-field appearance="outline" class="w-24">
            <input matInput type="number" min="1" [(ngModel)]="p.cantidad" />
          </mat-form-field>
        </td>
      </ng-container>

      <ng-container matColumnDef="descuento">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Descuento</th>
        <td mat-cell *matCellDef="let p">
          <mat-form-field appearance="outline" class="w-24">
            <input matInput type="number" min="0" [(ngModel)]="p.descuento" />
          </mat-form-field>
        </td>
      </ng-container>

      <ng-container matColumnDef="stock">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Stock</th>
        <td mat-cell *matCellDef="let p">{{ p.stock }}</td>
      </ng-container>

      <ng-container matColumnDef="almacen">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell">Almacén</th>
        <td mat-cell *matCellDef="let p">{{ p.almacen }}</td>
      </ng-container>

      <ng-container matColumnDef="accion">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell"></th>
        <td mat-cell *matCellDef="let p">
          <button mat-icon-button color="primary" (click)="seleccionar(p)" [disabled]="p.stock === 0">
            <mat-icon>add</mat-icon>
          </button>
        </td>
      </ng-container>

      <!-- Filas -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <!-- Sin resultados -->
  <div *ngIf="resultados.length === 0 && query" class="text-center text-gray-500 italic mt-4">
    No se encontraron resultados.
  </div>
</mat-dialog-content>

<!-- Acciones -->
<mat-dialog-actions align="end" class="p-4">
  <button mat-button (click)="cancelar()">Cancelar</button>
</mat-dialog-actions>
