import{a as B,b as kt,c as A,d as Tt,e as Nt}from"./chunk-RVWJPYBM.js";import{a as Lt}from"./chunk-KY3NGPN2.js";import{a as jt,b as vt,c as xt,d as bt,e as yt,f as St,g as It,h as Pt,i as Mt,j as Dt,k as wt,l as W}from"./chunk-4MVDCV4H.js";import{a as Et,b as Ft,c as Vt,d as $t,e as Ut,f as Rt}from"./chunk-7FAHWVTG.js";import"./chunk-OXDELVB2.js";import"./chunk-D7BAGR3P.js";import{a as k,d as ct,h as T,i as N,m as U,n as R}from"./chunk-P3BZCKAE.js";import{c as pt,e as y,g as dt,h as ut,k as ft,n as _t,o as ht,q as gt,s as $,t as Ct}from"./chunk-QHIXCQYV.js";import{T as nt,ba as at,ga as L,ka as V,ma as lt,na as mt}from"./chunk-GZIOB5VH.js";import"./chunk-QWI5PWUG.js";import{a as st}from"./chunk-3BSPIKHY.js";import{e as tt,f as et,i as it,j as ot,l as w,q as rt,x as E,z as F}from"./chunk-N75GUXKZ.js";import{$ as Y,$a as m,$b as G,Db as O,Hb as r,Ib as o,Jb as h,Kb as v,Lb as x,Nb as b,Tb as j,Vb as f,Zb as q,_b as Q,ab as u,cc as z,dc as l,ea as Z,ec as J,fc as _,ka as I,lc as P,mc as K,tc as M,ua as g,ub as p,va as C,vc as D,wb as s}from"./chunk-PTZSXNKB.js";import"./chunk-NEB6MB4Y.js";var H=(()=>{let e=class e{constructor(i){this.http=i,this.apiUrl=`${st.apiUrl}/Proyecto`}getProjects(){return this.http.get(`${this.apiUrl}/proyectos`)}getUnidadesDeNegocio(){return this.http.get(`${this.apiUrl}/unidades-negocio`)}getCategorias(){return this.http.get(`${this.apiUrl}/categorias`)}createProject(i){return this.http.post(`${this.apiUrl}/guardar-proyecto`,i)}updateProject(i){return this.http.post(`${this.apiUrl}/guardar-proyecto`,i)}deleteProject(i){return this.http.delete(`${this.apiUrl}/eliminar-proyecto/${i}`)}getProjectById(i){return this.http.get(`${this.apiUrl}/proyecto/${i}`)}};e.\u0275fac=function(a){return new(a||e)(Z(rt))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Jt=()=>({"=0":"No proyectos","=1":"proyecto",other:"proyectos"}),Kt=()=>[5,10,20];function Wt(t,e){if(t&1&&l(0),t&2){let c=f();_(" ",c.projectsCount," ")}}function Xt(t,e){if(t&1){let c=b();r(0,"button",10),j("click",function(){g(c);let a=f();return C(a.addProject())}),h(1,"mat-icon",11),r(2,"span",12),l(3,"Agregar Proyecto"),o()()}t&2&&(s("color","primary"),m(),s("svgIcon","heroicons_outline:plus"))}function Yt(t,e){t&1&&(r(0,"th",28),l(1," ID "),o())}function Zt(t,e){if(t&1&&(r(0,"td",29),l(1),o()),t&2){let c=e.$implicit;m(),_(" ",c.proyectoId," ")}}function te(t,e){t&1&&(r(0,"th",28),l(1," Nombre "),o())}function ee(t,e){if(t&1&&(r(0,"td",29),l(1),o()),t&2){let c=e.$implicit;m(),_(" ",c.nombre," ")}}function ie(t,e){t&1&&(r(0,"th",28),l(1," Categor\xEDa "),o())}function oe(t,e){if(t&1&&(r(0,"td",29),l(1),o()),t&2){let c=e.$implicit;m(),_(" ",c.categoria," ")}}function re(t,e){t&1&&(r(0,"th",28),l(1," Fecha Inicio "),o())}function ne(t,e){if(t&1&&(r(0,"td",29),l(1),M(2,"date"),o()),t&2){let c=e.$implicit;m(),_(" ",D(2,1,c.fechaInicio,"yyyy-MM-dd")," ")}}function ae(t,e){t&1&&(r(0,"th",28),l(1," Fecha Fin "),o())}function ce(t,e){if(t&1&&(r(0,"td",29),l(1),M(2,"date"),o()),t&2){let c=e.$implicit;m(),_(" ",D(2,1,c.fechaFin,"yyyy-MM-dd")," ")}}function le(t,e){t&1&&(r(0,"th",30),l(1," Acciones "),o())}function me(t,e){if(t&1){let c=b();r(0,"button",33),j("click",function(){g(c);let a=f().$implicit,n=f(2);return C(n.editProject(a.proyectoId))}),l(1,"Editar"),o()}}function se(t,e){if(t&1){let c=b();r(0,"button",34),j("click",function(){g(c);let a=f().$implicit,n=f(2);return C(n.deleteProject(a.proyectoId))}),l(1,"Eliminar"),o()}}function pe(t,e){if(t&1&&(r(0,"td",29),p(1,me,2,0,"button",31)(2,se,2,0,"button",32),o()),t&2){let c=f(2);m(),s("ngIf",c.tienePermiso("btnEdit")),m(),s("ngIf",c.tienePermiso("btndelete"))}}function de(t,e){t&1&&h(0,"tr",35)}function ue(t,e){t&1&&h(0,"tr",36)}function fe(t,e){if(t&1){let c=b();r(0,"div",8)(1,"mat-form-field",13)(2,"mat-label"),l(3,"Buscar"),o(),r(4,"input",14),j("keyup",function(a){g(c);let n=f();return C(n.applyFilter(a))}),o()(),r(5,"table",15),v(6,16),p(7,Yt,2,0,"th",17)(8,Zt,2,1,"td",18),x(),v(9,19),p(10,te,2,0,"th",17)(11,ee,2,1,"td",18),x(),v(12,20),p(13,ie,2,0,"th",17)(14,oe,2,1,"td",18),x(),v(15,21),p(16,re,2,0,"th",17)(17,ne,3,4,"td",18),x(),v(18,22),p(19,ae,2,0,"th",17)(20,ce,3,4,"td",18),x(),v(21,23),p(22,le,2,0,"th",24)(23,pe,3,2,"td",18),x(),p(24,de,1,0,"tr",25)(25,ue,1,0,"tr",26),o(),h(26,"mat-paginator",27),o()}if(t&2){let c=f();m(5),s("dataSource",c.dataSource),m(19),s("matHeaderRowDef",c.displayedColumns),m(),s("matRowDefColumns",c.displayedColumns),m(),s("pageSizeOptions",K(4,Kt))}}function _e(t,e){t&1&&(r(0,"div",9),l(1," Sin proyectos "),o())}var Ht=(()=>{let e=class e{constructor(i,a,n,d){this.projectService=i,this.router=a,this.snackBar=n,this.route=d,this.displayedColumns=["id","name","category","startDate","endDate","actions"],this.dataSource=new W,this.projectsCount=0,this.searchText="",this.permisosUsuario=[],this.vistaActual="",this.permisosDisponibles=[]}ngOnInit(){this.vistaActual=this.router.url,this.getProjects(),this.obtenerPermisos()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}getProjects(){this.projectService.getProjects().subscribe(i=>{this.projectsCount=i.length,this.dataSource=new W(i),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(i){this.dataSource.filter=i.target.value.trim().toLowerCase()}addProject(){this.router.navigate(["/dashboards/project/new"])}editProject(i){this.router.navigate([`/dashboards/project/${i}`])}deleteProject(i){this.projectService.deleteProject(i).subscribe(()=>{this.getProjects(),this.snackBar.open("Proyecto eliminado correctamente","Cerrar",{duration:3e3})})}obtenerPermisos(){let i=localStorage.getItem("userInformation");if(!i){console.warn("No se encontr\xF3 informaci\xF3n de usuario en localStorage.");return}let a=JSON.parse(i);console.log("vista actual ",this.vistaActual),console.log("permisos  ",a.permisos),this.permisosUsuario=a.permisos.filter(n=>n.vista.ruta===`${this.vistaActual}`),this.permisosDisponibles=this.permisosUsuario.map(n=>n.codigo),console.log("Permisos de esta vista:",this.permisosDisponibles)}tienePermiso(i){return this.permisosDisponibles.includes(i)}};e.\u0275fac=function(a){return new(a||e)(u(H),u(F),u(Lt),u(E))},e.\u0275cmp=I({type:e,selectors:[["app-project-list"]],viewQuery:function(a,n){if(a&1&&(q(B,5),q(A,5)),a&2){let d;Q(d=G())&&(n.paginator=d.first),Q(d=G())&&(n.sort=d.first)}},standalone:!0,features:[P],decls:15,vars:8,consts:[[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"flex-auto"],[1,"flex","flex-auto","flex-col","justify-between","border-b","px-6","py-8","sm:flex-row","md:flex-col","md:px-8"],[1,"text-4xl","font-extrabold","leading-none","tracking-tight"],[1,"text-secondary","ml-0.5","font-medium"],[1,"mt-4","flex","items-center","sm:mt-0","md:mt-4"],["class","ml-4","mat-flat-button","",3,"color","click",4,"ngIf"],[1,"relative"],[1,"mat-elevation-z8"],[1,"border-t","p-8","text-center","text-4xl","font-semibold","tracking-tight","sm:p-16"],["mat-flat-button","",1,"ml-4",3,"click","color"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"w-full"],["matInput","","placeholder","Filtrar proyectos",3,"keyup"],["mat-table","","matSort","",1,"w-full",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","category"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-button","","color","accent",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","accent",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,n){a&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),l(5," Proyectos "),o(),r(6,"div",4),p(7,Wt,1,1),l(8),M(9,"i18nPlural"),o()(),r(10,"div",5),p(11,Xt,4,2,"button",6),o()(),r(12,"div",7),p(13,fe,27,5,"div",8)(14,_e,2,0,"div",9),o()()()),a&2&&(m(7),O(n.projectsCount>0?7:-1),m(),_(" ",D(9,4,n.projectsCount,K(7,Jt))," "),m(3),s("ngIf",n.tienePermiso("btnAdd")),m(2),O(n.projectsCount>0?13:14))},dependencies:[w,et,it,ot,wt,jt,xt,It,bt,vt,Pt,yt,St,Mt,Dt,V,L,mt,lt,kt,B,Nt,A,Tt,N,T,k,R,U,$],encapsulation:2});let t=e;return t})();function he(t,e){if(t&1&&(r(0,"mat-option",17),l(1),o()),t&2){let c=e.$implicit;s("value",c.categoriaId),m(),J(c.nombre)}}function ge(t,e){if(t&1&&(r(0,"mat-option",17),l(1),o()),t&2){let c=e.$implicit;s("value",c.unidadId),m(),J(c.nombre)}}var X=(()=>{let e=class e{constructor(i,a,n,d){this.fb=i,this.projectService=a,this.route=n,this.router=d,this.categorias=[],this.unidadesDeNegocio=[],this.projectId=null}ngOnInit(){this.projectForm=this.fb.group({proyectoId:[0],nombre:["",y.required],categoria:["",y.required],lugar:["NA"],unidadDeNegocio:["",y.required],fechaInicio:["",y.required],fechaFin:[""],estado:["NA"]}),this.getCategorias(),this.getUnidadesDeNegocio(),this.route.paramMap.subscribe(i=>{let a=i.get("id");!a||a==="new"?this.projectId=null:(this.projectId=Number(a),this.loadProject(this.projectId))})}getCategorias(){this.projectService.getCategorias().subscribe(i=>this.categorias=i)}getUnidadesDeNegocio(){this.projectService.getUnidadesDeNegocio().subscribe(i=>this.unidadesDeNegocio=i)}loadProject(i){this.projectService.getProjectById(this.projectId).subscribe(a=>{let n=a;n&&this.projectForm.patchValue({proyectoId:n.proyectoId,nombre:n.nombre,categoria:n.categoriaId,lugar:n.lugar,unidadDeNegocio:n.unidadDeNegocioId,fechaInicio:n.fechaInicio,fechaFin:n.fechaFin,estado:n.estado})})}saveProject(){if(this.projectForm.invalid)return;let i=this.projectForm.value;console.log("data de proyecto ",i),this.projectId?(i.proyectoId=this.projectId,this.projectService.updateProject(i).subscribe(()=>{this.router.navigate(["/dashboards/project"])})):this.projectService.createProject(i).subscribe(()=>{this.router.navigate(["/dashboards/project"])})}};e.\u0275fac=function(a){return new(a||e)(u(gt),u(H),u(E),u(F))},e.\u0275cmp=I({type:e,selectors:[["app-project-details"]],standalone:!0,features:[P],decls:38,vars:8,consts:[["picker1",""],["picker2",""],[1,"absolute","inset-0","flex","flex-col","overflow-hidden","p-6"],[1,"text-2xl","font-bold","mb-4"],[1,"flex","flex-col","gap-4",3,"ngSubmit","formGroup"],["appearance","fill",1,"w-full"],["matInput","","formControlName","nombre"],["formControlName","categoria"],[3,"value",4,"ngFor","ngForOf"],["formControlName","unidadDeNegocio"],[1,"grid","grid-cols-2","gap-4"],["matInput","","formControlName","fechaInicio",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","fechaFin",3,"matDatepicker"],[1,"flex","justify-end","gap-2","mt-4"],["mat-raised-button","","color","primary","type","submit"],["mat-button","","color","warn","type","button",3,"click"],[3,"value"]],template:function(a,n){if(a&1){let d=b();r(0,"div",2)(1,"h1",3),l(2),o(),r(3,"form",4),j("ngSubmit",function(){return g(d),C(n.saveProject())}),r(4,"mat-form-field",5)(5,"mat-label"),l(6,"Nombre del Proyecto"),o(),h(7,"input",6),o(),r(8,"mat-form-field",5)(9,"mat-label"),l(10,"Categor\xEDa"),o(),r(11,"mat-select",7),p(12,he,2,2,"mat-option",8),o()(),r(13,"mat-form-field",5)(14,"mat-label"),l(15,"Unidad de Negocio"),o(),r(16,"mat-select",9),p(17,ge,2,2,"mat-option",8),o()(),r(18,"div",10)(19,"mat-form-field",5)(20,"mat-label"),l(21,"Fecha de Inicio"),o(),h(22,"input",11)(23,"mat-datepicker-toggle",12)(24,"mat-datepicker",null,0),o(),r(26,"mat-form-field",5)(27,"mat-label"),l(28,"Fecha de Fin"),o(),h(29,"input",13)(30,"mat-datepicker-toggle",12)(31,"mat-datepicker",null,1),o()(),r(33,"div",14)(34,"button",15),l(35,"Guardar"),o(),r(36,"button",16),j("click",function(){return g(d),C(n.router.navigate(["/dashboards/project"]))}),l(37,"Cancelar"),o()()()()}if(a&2){let d=z(25),S=z(32);m(2),_(" ",n.projectId?"Editar Proyecto":"Nuevo Proyecto"," "),m(),s("formGroup",n.projectForm),m(9),s("ngForOf",n.categorias),m(5),s("ngForOf",n.unidadesDeNegocio),m(5),s("matDatepicker",d),m(),s("for",d),m(6),s("matDatepicker",S),m(),s("for",S)}},dependencies:[w,tt,Ct,ft,pt,dt,ut,_t,ht,$,N,T,k,ct,R,U,Ft,Et,at,V,L,Rt,Vt,$t,Ut,nt],encapsulation:2});let t=e;return t})();var Xe=[{path:"",component:Ht},{path:"new",component:X},{path:":id",component:X}];export{Xe as default};
